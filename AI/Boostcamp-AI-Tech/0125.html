<!DOCTYPE html>
<html lang="ko-KR">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>01/25 Summary | LDH Note</title>
    <meta name="generator" content="VuePress 1.8.3">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16.png">
    <link rel="shortcut icon" href="/assets/favicons/favicon.ico">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-23KGQVB87M"></script>
    <script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-23KGQVB87M');</script>
    <meta name="description" content="부스트캠프 AI Tech 01/25 Summary">
    <meta property="og:title" content="01/25 Summary">
    <meta property="og:description" content="부스트캠프 AI Tech 01/25 Summary">
    <meta property="og:image" content="https://boostcamp.connect.or.kr/images/pavicon_180_v2.ico">
    <meta property="og:url" content="https://leedooho.com/AI/Boostcamp-AI-Tech/0125.html">
    <meta name="charset" content="utf-8">
    
    <link rel="preload" href="/assets/css/0.styles.10edf211.css" as="style"><link rel="preload" href="/assets/js/app.0ef05f26.js" as="script"><link rel="preload" href="/assets/js/2.7be8156e.js" as="script"><link rel="preload" href="/assets/js/18.ad7065eb.js" as="script"><link rel="preload" href="/assets/js/37.c7880ac5.js" as="script"><link rel="prefetch" href="/assets/js/10.52419b77.js"><link rel="prefetch" href="/assets/js/11.662ba05b.js"><link rel="prefetch" href="/assets/js/12.189d6f01.js"><link rel="prefetch" href="/assets/js/13.81ecece4.js"><link rel="prefetch" href="/assets/js/14.a674bf1c.js"><link rel="prefetch" href="/assets/js/15.3da3c840.js"><link rel="prefetch" href="/assets/js/16.e18de7c7.js"><link rel="prefetch" href="/assets/js/17.5d3e9bea.js"><link rel="prefetch" href="/assets/js/19.c89a62e1.js"><link rel="prefetch" href="/assets/js/20.733b42dd.js"><link rel="prefetch" href="/assets/js/21.d6485c5d.js"><link rel="prefetch" href="/assets/js/22.5294f975.js"><link rel="prefetch" href="/assets/js/23.4184da9c.js"><link rel="prefetch" href="/assets/js/24.e5607ab0.js"><link rel="prefetch" href="/assets/js/25.b62df304.js"><link rel="prefetch" href="/assets/js/26.295961da.js"><link rel="prefetch" href="/assets/js/27.a79d73e1.js"><link rel="prefetch" href="/assets/js/28.bf78ea18.js"><link rel="prefetch" href="/assets/js/29.b8b165d9.js"><link rel="prefetch" href="/assets/js/3.76558b67.js"><link rel="prefetch" href="/assets/js/30.9c2ce01a.js"><link rel="prefetch" href="/assets/js/31.1b46576c.js"><link rel="prefetch" href="/assets/js/32.1821c629.js"><link rel="prefetch" href="/assets/js/33.bf1751a1.js"><link rel="prefetch" href="/assets/js/34.45b4dd8e.js"><link rel="prefetch" href="/assets/js/35.62876489.js"><link rel="prefetch" href="/assets/js/36.b909f7e6.js"><link rel="prefetch" href="/assets/js/38.a6bd5a4b.js"><link rel="prefetch" href="/assets/js/39.01c90e8d.js"><link rel="prefetch" href="/assets/js/4.a9922f00.js"><link rel="prefetch" href="/assets/js/40.47859ce2.js"><link rel="prefetch" href="/assets/js/41.4c34e371.js"><link rel="prefetch" href="/assets/js/42.b90bda13.js"><link rel="prefetch" href="/assets/js/43.5cfe77a6.js"><link rel="prefetch" href="/assets/js/44.6bb4f33a.js"><link rel="prefetch" href="/assets/js/45.4ba03437.js"><link rel="prefetch" href="/assets/js/46.8f541616.js"><link rel="prefetch" href="/assets/js/47.61536cd3.js"><link rel="prefetch" href="/assets/js/48.478f71a0.js"><link rel="prefetch" href="/assets/js/49.f14d3fc6.js"><link rel="prefetch" href="/assets/js/5.0ba7bf9c.js"><link rel="prefetch" href="/assets/js/50.2c4375ea.js"><link rel="prefetch" href="/assets/js/51.99b9a6de.js"><link rel="prefetch" href="/assets/js/52.66d7a047.js"><link rel="prefetch" href="/assets/js/53.a3d76e1b.js"><link rel="prefetch" href="/assets/js/54.4912bc89.js"><link rel="prefetch" href="/assets/js/6.3be4ccd1.js"><link rel="prefetch" href="/assets/js/7.44679647.js"><link rel="prefetch" href="/assets/js/8.d8edd2eb.js"><link rel="prefetch" href="/assets/js/9.631d5f0b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.10edf211.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="global-layout"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/img/logo-50.png" alt="LDH Note" class="logo"> <span class="site-name can-hide">LDH Note</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/Portfolio/" class="nav-link">
  Portfolio
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/Portfolio/" class="nav-link">
  Portfolio
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>CS</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/CS/Algorithm/" class="sidebar-link">Algorithm</a></li><li><a href="/CS/APS/" class="sidebar-link">APS</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>AI</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Blockchain</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default" data-v-7468fe14 data-v-7468fe14><h3 id="_2022-01-25-새로-알게된-점" data-v-7468fe14><a href="#_2022-01-25-새로-알게된-점" class="header-anchor" data-v-7468fe14>#</a> 2022/01/25, 새로 알게된 점</h3> <p class="tags" data-v-7468fe14>#Module #Parameter #AutoGrad #Dataset #DataLoader #HuggingFace #Albumentations</p> <p data-v-7468fe14>  오늘은 학습을 위한 데이터 부분, Dataset &amp; DataLoader 에 관하여 학습하였다.
그 전에, 어제 배웠던 AutoGrad 에 대해서 다시 보자.</p> <h4 id="autograd" data-v-7468fe14><a href="#autograd" class="header-anchor" data-v-7468fe14>#</a> AutoGrad</h4> <p data-v-7468fe14>  먼저 PyTorch 에서는 <code data-v-7468fe14>torch.nn.Module</code> 이라는 큰 자유를 준다.
이곳에 원하는 방식으로, 마치 레고를 조립하듯이 쌓아나갈 수 있다.
정확하게는, 딥러닝을 구성하는 레이어의 base class 이다.
그래서 Input / Output / Forward / Backward 로 정의되는데, 여기서 Backward 가 AutoGrad 로 자동 미분이 일어난다.</p> <p data-v-7468fe14>  레이어에 포함되어 있는 Parameter 클래스 객체인 Weights 가 학습의 대상이 되어,
<code data-v-7468fe14>forward()</code> 의 결과값과 실제 값 간의 차이 <strong data-v-7468fe14>Loss</strong> 에 대해 미분을 수행하여 그라디언트를 계산하고,
<code data-v-7468fe14>step()</code> 시 이를 각각 파라미터의 <code data-v-7468fe14>.grad</code> 에 저장한다.</p> <p data-v-7468fe14>  Backward 는 module 단계에서 직접 개발이 가능하다. backward와 optimizer 를 오버라이딩하면 되지만,
그렇게 되면 직접 미분 수식을 써야한다. 그래서 새로운 구조를 개발하는 것이 아닌 이상 직접 개발하는 일은 드물다.</p> <h4 id="dataset-dataloader" data-v-7468fe14><a href="#dataset-dataloader" class="header-anchor" data-v-7468fe14>#</a> Dataset &amp; DataLoader</h4> <br data-v-7468fe14> <div class="img-center" data-v-7468fe14><img src="https://github.com/BlueYellowGreen/BlueYellowGreen.github.io/blob/main/.vuepress/public/assets/img/Dataset-DataLoader.png?raw=true" data-v-7468fe14></div> <p data-v-7468fe14>  PyTorch 의 data handling 관련 구조는 위의 그림과 같다.
<strong data-v-7468fe14>Dataset</strong> 에서 <strong data-v-7468fe14>데이터의 정보, 길이, 데이터를 어떻게 불러올 것인지</strong>에 대한 내용이 반드시 포함되어 있어야 한다.
그리고 일반적으로 데이터 학습을 시키기 위해 Tensor 형태로 바꿔줘야 하는데, 이 작업은 주로
<strong data-v-7468fe14>transforms</strong> 에서 이루어진다.</p> <p data-v-7468fe14>  transforms 는 간단한 전처리부터 시작해서 데이터 증강 기법까지 다루는데, CV 라면 torchvision.transform 에 NLP 라면
torchtext 에 해당 함수들을 이용한다. 내장 함수 이외에도, 이미지 처리를 위해 <span style="color:#2454ff;" data-v-7468fe14><strong data-v-7468fe14>Albumentations</strong></span> 라이브러리를
많이 사용하기도 한다. NLP 에서는 데이터 증강까진 아니지만 Backbone 모델 및 다양한 데이터를 <span style="color:#2454ff;" data-v-7468fe14><strong data-v-7468fe14>HuggingFace</strong></span> 에서 얻는다.</p> <p data-v-7468fe14>  DataLoader의 경우 제작한 Dataset 클래스로 만든 인스턴스를 이용하여 만들어지는 generator 이다.
그러다보니, 방대한 양의 데이터가 있어도 하드웨어 자원에 맞게 batch 학습을 돌릴 수 있다.
DataLoader 에서 중요한 기능은 <span style="color:#2454ff;" data-v-7468fe14><strong data-v-7468fe14>sampler</strong></span> 와 <span style="color:#2454ff;" data-v-7468fe14><strong data-v-7468fe14>collate_fn</strong></span> 을 들 수 있다.</p> <p data-v-7468fe14><code data-v-7468fe14>sampler</code> 는 shuffle=False 일 때 사용할 수 있는 기능으로, 데이터를 어떻게 뽑을지 인덱스 설정에 관한 것이다.
주로 불균형 데이터에서 고른 비율로 데이터를 선별할 때 사용된다.</p> <p data-v-7468fe14><code data-v-7468fe14>collate_fn</code> 는 추가적인 데이터 처리 작업에 관한 것으로 batch 단위로 적용된다.<br data-v-7468fe14>
Dataset 의 <code data-v-7468fe14>__getitem()__</code> 이나 transforms 로 처리하면 되지 않을까 하는 생각이 들지만, 이들은 모두 데이터 <strong data-v-7468fe14>독립적</strong>으로 개별마다 적용된다.
즉, 다른 데이터와의 상호작용을 기대할 수 없는데, <strong data-v-7468fe14>collate_fn</strong> 의 경우 <strong data-v-7468fe14>batch 단위</strong>의 데이터들에 대해 서로 접근이 가능하다는 차이가 있다.
그래서 주로 Data 와 Label 이 쌍으로 묶여 있는 dataset 에 대해서 따로 따로 <strong data-v-7468fe14>분리</strong>를 시켜주거나,
다양한 길이의 텍스트에 대해 0 으로 패딩을 줘 고른 길이로 만드는 등에 주로 사용된다. (NLP 영역)</p> <br data-v-7468fe14> <hr data-v-7468fe14> <h3 id="피어-세션" data-v-7468fe14><a href="#피어-세션" class="header-anchor" data-v-7468fe14>#</a> 피어 세션</h3> <p data-v-7468fe14>오늘도 역시나 과제가 상당하다.</p> <p data-v-7468fe14>하나 하나 내용이 매우 알차다보니 소화시키는데 다소 걸릴 것 같다.</p> <p data-v-7468fe14>사실상 이번 주 학습 내용이 PyTorch 전반에 관한 사용법을 다루다보니 이것을 잘만 익혀내도,
추후에 논문을 코드로 구현해내거나, 다른 사람의 코드를 해석하는데 무리가 없을 것 같다.</p> <br data-v-7468fe14> <br data-v-7468fe14> <br data-v-7468fe14></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div> <div></div> <br> <br> <footer class="siteFooter"><p>© 2021 이두호. ALL RIGHTS RESERVED.</p> <p><span>dhdev5ba@gmail.com</span> <span> </span> <a target="_blank" href="https://github.com/BlueYellowGreen/">GITHUB</a> <span> </span> <a target="_blank" href="https://www.linkedin.com/in/dooho-lee-56b295219/">LINKEDIN</a></p></footer></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.0ef05f26.js" defer></script><script src="/assets/js/2.7be8156e.js" defer></script><script src="/assets/js/18.ad7065eb.js" defer></script><script src="/assets/js/37.c7880ac5.js" defer></script>
  </body>
</html>
