(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{383:function(t,s,a){},440:function(t,s,a){"use strict";a(383)},514:function(t,s,a){"use strict";a.r(s);a(440);var n=a(33),r=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h3",{attrs:{id:"_2022-01-26-새로-알게된-점"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2022-01-26-새로-알게된-점"}},[t._v("#")]),t._v(" 2022/01/26, 새로 알게된 점")]),t._v(" "),a("p",{staticClass:"tags"},[t._v("#Save_&_Load #Transfer_learning #Monitoring")]),t._v(" "),a("p",[t._v("  학습 결과를 남들에게 공유하거나(재현 및 전이 학습 용도로 사용), 자원이 부족한 경우 checkpoint 바탕으로 이어서 학습하기 위해\n모델을 "),a("strong",[t._v("저장")]),t._v("하고 "),a("strong",[t._v("불러올 줄 알아야 한다.")]),t._v(" 특히나 나의 경우 GPU가 마땅치 않아 Colab 에서 주로 학습을 돌리는데, pro + 를\n구독하지 않는 이상, 런타임 초기화의 늪에서 벗어날 수 없다.")]),t._v(" "),a("p",[t._v("  그래서 Colab에 구글 드라이브를 마운트하고, 학습이 진행되며 "),a("strong",[t._v("주기적으로 checkpoint 저장하는 방식")]),t._v("을 사용하면,\n압박감에서 조금이나마 벗어날 수 있다. 그리고 추가적으로 매 epoch 마다 metric 값을 slack, 더 나아가 카카오톡에 공유하도록\n해 놓으면 조금 더 그럴싸하다.")]),t._v(" "),a("h4",{attrs:{id:"torch-save"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#torch-save"}},[t._v("#")]),t._v(" torch.save()")]),t._v(" "),a("p",[t._v("  PyTorch에 구현되어 있는 "),a("code",[t._v("model.save()")]),t._v(" 함수로 아주 쉽게 모델 아키텍처와 파라미터를 저장할 수 있다.")]),t._v(" "),a("ol",[a("li",[t._v("모델 아키텍처와 파라미터 함께 저장 및 불러오기")])]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("torch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("save"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("모델_클래스_인스턴스"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'저장할_경로/이름.pt'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nmodel "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" torch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("load"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'저장한_경로/이름.pt'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[t._v("모델 파라미터만 저장")])]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("torch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("save"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("모델_클래스_인스턴스"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state_dict"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'저장할_경로/이름.pt'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nmodel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("load_state_dict"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("torch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("load"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'저장된_경로/이름.pt'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("파라미터를 저장할 때 사용하는 "),a("code",[t._v("model.state_dict()")]),t._v(" 은 각 레이어에서 "),a("strong",[t._v("학습 가능한")]),t._v(" 매개변수 및 "),a("strong",[t._v("버퍼")]),t._v("를 dict 타입 객체로 불러온다.\n그리고 "),a("code",[t._v("state_dict()")]),t._v(" 을 사용하려면, 해당 정보에는 모델 아키텍처 정보가 없으므로, 미리 동일한 모델 코드가 준비되어 있어야 한다.")]),t._v(" "),a("p",[t._v("참고로 여기서는 경로를 단순히 string 으로 작성했지만, OS 마다 경로 표현 방식의 차이가 있어서 하드 코딩보다는 "),a("code",[t._v("os.path.join()")]),t._v(" 처럼\nOS에 맞게 경로를 생성해주는 함수를 사용하자.")]),t._v(" "),a("p",[t._v("여기서 더 나아가, "),a("strong",[t._v("epoch, optimizer, loss")]),t._v(" 등의 정보를 함께 저장해서 추후에 학습을 이어나갈 수 있도록 해보자.")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# save")]),t._v("\ntorch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("save"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'model_state_dict'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" model"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state_dict"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'epoch'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" epoch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'optimizer_state_dict'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" optimizer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state_dict"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'loss'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" loss"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string-interpolation"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v("f'checkpoint_epoch")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("epoch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("_")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("loss"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v(".pt'")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# load")]),t._v("\ncheckpoint "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" torch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("load"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'경로/모델.pt'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nmodel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("load_state_dict"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("checkpoint"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'model_state_dict'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nepoch "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" checkpoint"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'epoch'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\noptimizer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("load_state_dict"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("checkpoint"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'optimizer_state_dict'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nloss "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" checkpoint"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'loss'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("h4",{attrs:{id:"transfer-learning"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#transfer-learning"}},[t._v("#")]),t._v(" Transfer Learning")]),t._v(" "),a("p",[t._v("  요즘의 추세는 기존에 대용량 학습 데이터로 학습된 Backbone 모델을 이용하여,\n학습 데이터에 맞게 레이어를 변경해준 뒤 다시 학습을 시킨다.\n특히나 NLP의 경우, "),a("a",{attrs:{href:"https://huggingface.co/models",target:"_blank",rel:"noopener noreferrer"}},[a("strong",[t._v("HuggingFace")]),a("OutboundLink")],1),t._v("에서 주로 전이학습시킬 Backbone 모델을 가져온다.")]),t._v(" "),a("p",[t._v("  전체 재학습을 시킬 수도 있지만, 기존 모델은 freeze 시키고, 새로 추가하거나 변형시킨 부분만 학습이 되도록 설정한다.\n그 방식은 아래의 코드를 이용하면 된다.")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" param "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" model"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("parameters"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 모델에 있는 모든 파라미터에 대해서")]),t._v("\n    param"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("requires_grad "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 일단은 학습하지 않도록 freeze 시키고,")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" param "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" model"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("linear_layers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("parameters"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 새롭게 변형시킨 레이어만")]),t._v("\n    param"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("requires_grad "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("                  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 학습이 되도록 한다.")]),t._v("\n")])])]),a("p",[t._v("위의 예시에서 "),a("code",[t._v(".linear_layers")]),t._v(" 부분은, class 개수에 맞게 마지막 레이어를 변경하는 경우가 많아 선택한 것이지,\n실제로는 추가하거나 "),a("strong",[t._v("수정한 레이어에 대해서 freeze를 해제")]),t._v("하면 된다. 이외에도 특정 레이어에 접근해서 수정하는 방식은\n"),a("a",{attrs:{href:"https://pytorch.org/tutorials/beginner/finetuning_torchvision_models_tutorial.html#alexnet",target:"_blank",rel:"noopener noreferrer"}},[a("strong",[t._v("공식문서")]),a("OutboundLink")],1),t._v("를 참고하자.")]),t._v(" "),a("h4",{attrs:{id:"monitoring"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#monitoring"}},[t._v("#")]),t._v(" Monitoring")]),t._v(" "),a("p",[t._v("  학습이 잘 진행되는지, 안된다면 그 원인을 파악하기 위해서 모니터링은 필수이다. 대표적인 모니터링 도구로는\n"),a("span",{staticStyle:{color:"#2454ff"}},[a("strong",[t._v("Tensorboard")])]),t._v(" 와 "),a("span",{staticStyle:{color:"#2454ff"}},[a("strong",[t._v("WandB")])]),t._v(" 가 있다.")]),t._v(" "),a("p",[a("span",{staticStyle:{color:"#2454ff"}},[a("strong",[t._v("Tensorboard")])]),t._v(" 의 경우 TensorFlow 의 프로젝트로 만들어진 시각화 도구이지만 PyTorch 에서도 사용 가능하다.\nmetric 등 상수 값을 표시하는 "),a("code",[t._v("scalar")]),t._v(", 모델의 computational graph 를 표시하는 "),a("code",[t._v("graph")]),t._v(",\nweight 같은 값의 분포를 표현하는 "),a("code",[t._v("histogram")]),t._v(", 실제 이미지와 예측 이미지를 표시하는 "),a("code",[t._v("image")]),t._v(",\n그리고 3d 형태의 데이터를 표현하는 "),a("code",[t._v("mesh")]),t._v(" (어떤 식으로 사용되는지 감이 안온다.) 등 기능이 다양하다.")]),t._v(" "),a("p",[t._v("사용하기 위해서는 경로를 지정해야 한다. Tensorboard 는 크게 하나의 프로젝트로 보며, 하위 폴더를 개별 실험으로 취급한다.")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" os\nlogs_dir "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'project_name'")]),t._v("\nos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("makedirs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("logs_dir"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" exist_ok"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("프로젝트 로그 관리를 위한 폴더를 만들었으면, 실험 마다 하위 폴더를 설정해 기록한다.\n"),a("span",{staticStyle:{color:"#2454ff"}},[a("strong",[t._v("6006 포트")])]),t._v("에서 확인 가능하다.")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" torch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("utils"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tensorboard "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" SummaryWriter\n\nexp "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string-interpolation"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v("f'")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("logs_dir"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("/exp_1'")])]),t._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 개별 실험 공간을 위한 경로 지정")]),t._v("\nwriter "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" SummaryWriter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("exp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 해당 경로로 기록을 작성하기 위한 객체 생성")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" epoch "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("epochs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 설명을 위한 가상의 학습 진행 과정")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" batch "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" datasets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Loss/train 의 의미는,")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Loss 라는 카테고리에 train 항목으로 기록한다는 뜻이다.")]),t._v("\n        writer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("add_scalar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Loss/train'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" batch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        writer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("add_scalar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Loss/test'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" batch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        writer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("add_scalar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Accuracy/train'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" batch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        writer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("add_scalar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Accuracy/test'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" batch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    writer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("flush"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 탭 레벨에 따라 배치마다 업데이트 되거나, 에폭마다, 아니면 학습 완료 후 업데이트 된다.")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 아래의 매직메서드로 Colab 에서 바로 확인 가능")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 보통 다른 셀에서 실행시킨다.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("load_ext tensorboard\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("tensorborad "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("logdirs "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'project_name'")]),t._v("\n")])])]),a("br"),t._v(" "),a("p",[a("span",{staticStyle:{color:"#2454ff"}},[a("strong",[t._v("WandB")])]),t._v(" 의 경우 협업 시 큰 장점을 가지고, 이로 인해 MLOPs의 대표적인 툴로 부상하고 있다.\n개인 사용자의 경우 100GB 사용량에 한하여 사용이 자유롭고, 팀 단위도 학습이 목적일 경우 무료이다.\n"),a("a",{attrs:{href:"https://wandb.ai/wandb_fc/korean/reports/Weights-Biases-Data-Science---Vmlldzo4MDEwNzc",target:"_blank",rel:"noopener noreferrer"}},[a("strong",[t._v("Weights & Biases")]),a("OutboundLink")],1),t._v("에서 설명하듯이,\n"),a("strong",[t._v("Dashborad")]),t._v(", "),a("strong",[t._v("Artifacts")]),t._v("(모델, 데이터 버전 관리), "),a("strong",[t._v("Sweep")]),t._v("(Hyperparamter Optimization), "),a("strong",[t._v("Report")]),t._v(" 같은\n유용한 기능들을 제공한다.")]),t._v(" "),a("p",[t._v("사용법 또한 간단하다."),a("br"),t._v("\nwandb 라이브러리를 설치 후 congiguration 내용을 설정한 뒤, 매 학습마다 기록할 metric을 dict 타입으로 넘기면 된다.")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# !pip install wandb")]),t._v("\n\nconfig "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'epochs'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" epochs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'batch_size'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" batch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'learning_rate'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" lr\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# wandb 상에 생성한 프로젝트 이름과 동일해야 한다.")]),t._v("\nwandb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("init"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("project"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'project_name'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" config"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" epoch "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("epochs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n    wandb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'accuracy'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" acc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'loss'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" loss"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("br"),t._v(" "),a("hr"),t._v(" "),a("h3",{attrs:{id:"피어-세션"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#피어-세션"}},[t._v("#")]),t._v(" 피어 세션")]),t._v(" "),a("p",[t._v("wandb 를 이용한 협업 연습 겸 경진대회에 참여해보자!")]),t._v(" "),a("br"),t._v(" "),a("br"),t._v(" "),a("br")])}),[],!1,null,"62e122ed",null);s.default=r.exports}}]);