<!DOCTYPE html>
<html lang="ko-KR">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>02/18 Summary | LDH Note</title>
    <meta name="generator" content="VuePress 1.8.3">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16.png">
    <link rel="shortcut icon" href="/assets/favicons/favicon.ico">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-23KGQVB87M"></script>
    <script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-23KGQVB87M');</script>
    <meta name="description" content="부스트캠프 AI Tech 02/18 Summary">
    <meta property="og:title" content="02/18 Summary">
    <meta property="og:description" content="부스트캠프 AI Tech 02/18 Summary">
    <meta property="og:image" content="https://boostcamp.connect.or.kr/images/pavicon_180_v2.ico">
    <meta property="og:url" content="https://leedooho.com/AI/Boostcamp-AI-Tech/0218.html">
    <meta name="charset" content="utf-8">
    
    <link rel="preload" href="/assets/css/0.styles.10edf211.css" as="style"><link rel="preload" href="/assets/js/app.0ef05f26.js" as="script"><link rel="preload" href="/assets/js/2.7be8156e.js" as="script"><link rel="preload" href="/assets/js/31.1b46576c.js" as="script"><link rel="preload" href="/assets/js/37.c7880ac5.js" as="script"><link rel="prefetch" href="/assets/js/10.52419b77.js"><link rel="prefetch" href="/assets/js/11.662ba05b.js"><link rel="prefetch" href="/assets/js/12.189d6f01.js"><link rel="prefetch" href="/assets/js/13.81ecece4.js"><link rel="prefetch" href="/assets/js/14.a674bf1c.js"><link rel="prefetch" href="/assets/js/15.3da3c840.js"><link rel="prefetch" href="/assets/js/16.e18de7c7.js"><link rel="prefetch" href="/assets/js/17.5d3e9bea.js"><link rel="prefetch" href="/assets/js/18.ad7065eb.js"><link rel="prefetch" href="/assets/js/19.c89a62e1.js"><link rel="prefetch" href="/assets/js/20.733b42dd.js"><link rel="prefetch" href="/assets/js/21.d6485c5d.js"><link rel="prefetch" href="/assets/js/22.5294f975.js"><link rel="prefetch" href="/assets/js/23.4184da9c.js"><link rel="prefetch" href="/assets/js/24.e5607ab0.js"><link rel="prefetch" href="/assets/js/25.b62df304.js"><link rel="prefetch" href="/assets/js/26.295961da.js"><link rel="prefetch" href="/assets/js/27.a79d73e1.js"><link rel="prefetch" href="/assets/js/28.bf78ea18.js"><link rel="prefetch" href="/assets/js/29.b8b165d9.js"><link rel="prefetch" href="/assets/js/3.76558b67.js"><link rel="prefetch" href="/assets/js/30.9c2ce01a.js"><link rel="prefetch" href="/assets/js/32.1821c629.js"><link rel="prefetch" href="/assets/js/33.bf1751a1.js"><link rel="prefetch" href="/assets/js/34.45b4dd8e.js"><link rel="prefetch" href="/assets/js/35.62876489.js"><link rel="prefetch" href="/assets/js/36.b909f7e6.js"><link rel="prefetch" href="/assets/js/38.a6bd5a4b.js"><link rel="prefetch" href="/assets/js/39.01c90e8d.js"><link rel="prefetch" href="/assets/js/4.a9922f00.js"><link rel="prefetch" href="/assets/js/40.47859ce2.js"><link rel="prefetch" href="/assets/js/41.4c34e371.js"><link rel="prefetch" href="/assets/js/42.b90bda13.js"><link rel="prefetch" href="/assets/js/43.5cfe77a6.js"><link rel="prefetch" href="/assets/js/44.6bb4f33a.js"><link rel="prefetch" href="/assets/js/45.4ba03437.js"><link rel="prefetch" href="/assets/js/46.8f541616.js"><link rel="prefetch" href="/assets/js/47.61536cd3.js"><link rel="prefetch" href="/assets/js/48.478f71a0.js"><link rel="prefetch" href="/assets/js/49.f14d3fc6.js"><link rel="prefetch" href="/assets/js/5.0ba7bf9c.js"><link rel="prefetch" href="/assets/js/50.2c4375ea.js"><link rel="prefetch" href="/assets/js/51.99b9a6de.js"><link rel="prefetch" href="/assets/js/52.66d7a047.js"><link rel="prefetch" href="/assets/js/53.a3d76e1b.js"><link rel="prefetch" href="/assets/js/54.4912bc89.js"><link rel="prefetch" href="/assets/js/6.3be4ccd1.js"><link rel="prefetch" href="/assets/js/7.44679647.js"><link rel="prefetch" href="/assets/js/8.d8edd2eb.js"><link rel="prefetch" href="/assets/js/9.631d5f0b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.10edf211.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="global-layout"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/img/logo-50.png" alt="LDH Note" class="logo"> <span class="site-name can-hide">LDH Note</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/Portfolio/" class="nav-link">
  Portfolio
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/Portfolio/" class="nav-link">
  Portfolio
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>CS</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/CS/Algorithm/" class="sidebar-link">Algorithm</a></li><li><a href="/CS/APS/" class="sidebar-link">APS</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>AI</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Blockchain</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default" data-v-ce35a002 data-v-ce35a002><h3 id="_2022-02-18-새로-알게된-점" data-v-ce35a002><a href="#_2022-02-18-새로-알게된-점" class="header-anchor" data-v-ce35a002>#</a> 2022/02/18, 새로 알게된 점</h3> <p class="tags" data-v-ce35a002>#docker #mlflow</p> <p data-v-ce35a002>  16일날 백신 3차 접종 후 팔에 통증과 두통이 생겨 17일까지 내리 잤다. 그래서 학습 기록을 못했는데, 오늘은
팀원들과 같이 스페셜 미션을 해결해보고 이야기해보는 시간을 가졌다. 그곳에서 내가 발표한 것은 Docker 를 통해
MLflow 를 사용해보는 것이었다.</p> <br data-v-ce35a002> <img src="https://raw.githubusercontent.com/BlueYellowGreen/BlueYellowGreen.github.io/main/.vuepress/public/assets/img/mlflow.png" data-v-ce35a002> <p data-v-ce35a002>  협업을 위해서는, Cloud 상에 데이터 (Metric, Params, ... &amp; Model, Data)를 저장하고, MLflow 를 통해 모니터링하는
방식으로 진행해야 한다. 하지만 당장 클라우드의 Storage 서비스를 이용하기에는 부담이 있으므로, 로컬에서 진행하되
<span style="color:#2454ff;" data-v-ce35a002><strong data-v-ce35a002>로컬 저장소</strong></span>를 Docker Container 에 <span style="color:#2454ff;" data-v-ce35a002><strong data-v-ce35a002>마운트</strong></span>할 것이고,
Docker 에서 웹서버를 열어 로컬에서 확인하는 방식을 진행할 것이다.<br data-v-ce35a002>
(Window &amp; WSL2 기준으로 진행)</p> <br data-v-ce35a002> <div class="language-dockerfile extra-class" data-v-ce35a002><pre class="language-dockerfile" data-v-ce35a002><code data-v-ce35a002><span class="token instruction" data-v-ce35a002><span class="token keyword" data-v-ce35a002>FROM</span> python:3.8.7-slim-buster</span>

<span class="token instruction" data-v-ce35a002><span class="token keyword" data-v-ce35a002>WORKDIR</span> app/</span>

<span class="token instruction" data-v-ce35a002><span class="token keyword" data-v-ce35a002>ENV</span> PYTHONPATH=/app</span>
<span class="token instruction" data-v-ce35a002><span class="token keyword" data-v-ce35a002>ENV</span> PYTHONBUFFERED=1</span>

<span class="token instruction" data-v-ce35a002><span class="token keyword" data-v-ce35a002>RUN</span> pip install pip==21.2.4 &amp;&amp; <span class="token operator" data-v-ce35a002>\</span>
    pip install mlflow</span>

<span class="token instruction" data-v-ce35a002><span class="token keyword" data-v-ce35a002>CMD</span> [<span class="token string" data-v-ce35a002>&quot;mlflow&quot;</span>, <span class="token string" data-v-ce35a002>&quot;ui&quot;</span>, <span class="token string" data-v-ce35a002>&quot;--host&quot;</span>, <span class="token string" data-v-ce35a002>&quot;0.0.0.0&quot;</span>]</span>
</code></pre></div><p data-v-ce35a002>위와 같이 <span style="color:#2454ff;" data-v-ce35a002><strong data-v-ce35a002>Dockerfile</strong></span> 을 작성한다.
여러 방식이 있겠지만, 단순하게 python slim 버전의 이미지를 가지고 와서 mlflow 를 설치한 뒤,
<code data-v-ce35a002>mlflow ui</code> 를 통해 웹서버를 연다. 여기서 주의해야 하는 점은, Dokcer Container 에서 웹서버를 열기 때문에,
외부에서 접속할 수 있도록 ip 를 허용해야 한다. 이는 <code data-v-ce35a002>--host “0.0.0.0”</code> 태그를 통해 가능하다.</p> <br data-v-ce35a002> <p data-v-ce35a002>그런 다음, WSL2 Ubuntu 속 해당 Dockerfile 이 있는 경로에서 app 폴더를 만든 뒤, 다음의 명령어로 빌드한다.</p> <div class="language-bash extra-class" data-v-ce35a002><pre class="language-bash" data-v-ce35a002><code data-v-ce35a002>docker build -t 이미지_이름
</code></pre></div><p data-v-ce35a002>이미지_이름 부분에 원하는 이름을 적고, 버전을 명시하려면 이미지_이름:0.1 처럼 작성한다. <strong data-v-ce35a002>버전을 명시하지 않으면
최신버전으로 인식</strong>된다.</p> <br data-v-ce35a002> <p data-v-ce35a002>  이미지가 성공적으로 생성되었으면, docker images 에서 이미지_이름 으로 생성된 것을 확인할 수 있다.
그 다음으로 컨테이너를 생성 및 실행 (RUN) 하면 되지만, 그 전에 로컬에서 작업해야 할 사항이 있다.</p> <p data-v-ce35a002>  현재 목표는, 로컬(윈도우)에서 <strong data-v-ce35a002>편하게 작업</strong> (PyTorch 를 사용하고, MLflow 로 train.py 실행 등) 하기 위함이다.
따라서 <strong data-v-ce35a002>로컬</strong>에서 원하는 아무곳에 <strong data-v-ce35a002>폴더를 생성</strong>하고 <strong data-v-ce35a002>가상환경 설정</strong>한다.
그런 다음 다음의 명령어를 통해 <strong data-v-ce35a002>실험을 생성</strong>한다.</p> <div class="language-bash extra-class" data-v-ce35a002><pre class="language-bash" data-v-ce35a002><code data-v-ce35a002>mlflow experiments create --experiment-name 실험_이름
</code></pre></div><p data-v-ce35a002>그러면 해당 경로에 mlruns 라는 폴더가 생긴다. 이러면 당장 필요한 것은 끝났다. 물론 해당 실험 하위로 각종
mlflow run 하기 위해서는 해당 실험 폴더마다 MLProject 란 파일을 생성해야 하지만, 마지막에 다룬다.
Window Terminals 같은 App 을 통해 Ubuntu 터미널을 열고, 로컬 경로로 접근한다.</p> <div class="language-bash extra-class" data-v-ce35a002><pre class="language-bash" data-v-ce35a002><code data-v-ce35a002><span class="token builtin class-name" data-v-ce35a002>cd</span> /mnt/c/Users/유저이름/<span class="token punctuation" data-v-ce35a002>..</span>./폴더를_생성한_곳
</code></pre></div><p data-v-ce35a002>해당 경로에서 다음의 명령어로 컨테이너를 생성 및 실행한다.</p> <div class="language-bash extra-class" data-v-ce35a002><pre class="language-bash" data-v-ce35a002><code data-v-ce35a002>docker run -d -p <span class="token number" data-v-ce35a002>5000</span>:5000 -v <span class="token variable" data-v-ce35a002><span class="token variable" data-v-ce35a002>`</span><span class="token builtin class-name" data-v-ce35a002>pwd</span><span class="token variable" data-v-ce35a002>`</span></span>:/app 이미지_이름
</code></pre></div><p data-v-ce35a002>현재 로컬 폴더를 docker container 의 저장소로 마운트 함으로써, 컨테이너를 삭제해도 데이터는 날라가지 않으며,
로컬(윈도우)에서 편하게 작업하고 이를 바로 <code data-v-ce35a002>http://localhost:5000</code> 에서 확인할 수 있다. 참고로 mlflow 로 run
하는 명령어는 다음과 같다.</p> <div class="language-bash extra-class" data-v-ce35a002><pre class="language-bash" data-v-ce35a002><code data-v-ce35a002>mlflow run 실행하고자_하는_폴더_이름 --experiment-name 실험_이름 --no-conda
</code></pre></div><p data-v-ce35a002>하나의 Run 은 이제 웹에서 확인할 수 있다!<br data-v-ce35a002>
그리고 아까 언급했듯이, 하나의 run 을 위해 해당 경로에 <span style="color:#2454ff;" data-v-ce35a002><strong data-v-ce35a002>MLProject</strong></span> 파일이 있어야 한다.
가장 기본적인 구조는 다음과 같다.</p> <div class="language-text extra-class" data-v-ce35a002><pre class="language-text" data-v-ce35a002><code data-v-ce35a002>name: tutorial

entry_points:
    main:
        command: &quot;python train.py&quot;
</code></pre></div><p data-v-ce35a002>해당 파일이 run 마다 있어야 한다!</p> <br data-v-ce35a002> <br data-v-ce35a002></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div> <div></div> <br> <br> <footer class="siteFooter"><p>© 2021 이두호. ALL RIGHTS RESERVED.</p> <p><span>dhdev5ba@gmail.com</span> <span> </span> <a target="_blank" href="https://github.com/BlueYellowGreen/">GITHUB</a> <span> </span> <a target="_blank" href="https://www.linkedin.com/in/dooho-lee-56b295219/">LINKEDIN</a></p></footer></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.0ef05f26.js" defer></script><script src="/assets/js/2.7be8156e.js" defer></script><script src="/assets/js/31.1b46576c.js" defer></script><script src="/assets/js/37.c7880ac5.js" defer></script>
  </body>
</html>
